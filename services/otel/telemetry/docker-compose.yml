services:
  signoz-otel-collector:
    image: signoz/signoz-otel-collector:v0.142.0
    user: "10001:10001"
    command:
      - --config=/etc/otelcol/config.yaml
      - --manager-config=/etc/otelcol/manager-config.yaml
      - --copy-path=/var/tmp/collector-config.yaml
    volumes:
      - ./config/otel-collector-config.yaml:/etc/otelcol/config.yaml:ro
      - ./config/otel-collector-opamp-config.yaml:/etc/otelcol/manager-config.yaml:ro
    ports:
      - "127.0.0.1:4317:4317"   # OTLP gRPC
      - "127.0.0.1:4318:4318"   # OTLP HTTP
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:13133/"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 30s
    networks:
      - arc_otel_net
    restart: unless-stopped

networks:
  arc_otel_net:
    name: arc_otel_net
