import{_ as c,C as s,o,c as t,a2 as l,b as d,w as i,a as r,E as n,a3 as m}from"./chunks/framework.C-cuuT8Z.js";const T=JSON.parse('{"title":"Tasks: Messaging & Cache Services Setup","description":"","frontmatter":{},"headers":[],"relativePath":"003-messaging-setup/tasks.md","filePath":"003-messaging-setup/tasks.md","lastUpdated":1772310733000}'),h={name:"003-messaging-setup/tasks.md"};function u(g,e,p,k,f,v){const a=s("Mermaid");return o(),t("div",null,[e[1]||(e[1]=l(`<h1 id="tasks-messaging-cache-services-setup" tabindex="-1">Tasks: Messaging &amp; Cache Services Setup <a class="header-anchor" href="#tasks-messaging-cache-services-setup" aria-label="Permalink to &quot;Tasks: Messaging &amp; Cache Services Setup&quot;">​</a></h1><blockquote><p><strong>Spec</strong>: 003-messaging-setup <strong>Date</strong>: 2026-02-23</p></blockquote><h2 id="task-format" tabindex="-1">Task Format <a class="header-anchor" href="#task-format" aria-label="Permalink to &quot;Task Format&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[TASK-NNN] [P?] [MODULE] [PRIORITY] Description</span></span>
<span class="line"><span>  Dependencies: [TASK-XXX] or none</span></span>
<span class="line"><span>  Module: services/{role}</span></span>
<span class="line"><span>  Acceptance: Testable criteria</span></span>
<span class="line"><span>  Status: [ ] pending | [~] in-progress | [x] done</span></span></code></pre></div><ul><li><code>[P]</code> = Safe for parallel agent execution</li><li>Priority: P1 (must), P2 (should), P3 (nice)</li></ul><h2 id="dependency-graph" tabindex="-1">Dependency Graph <a class="header-anchor" href="#dependency-graph" aria-label="Permalink to &quot;Dependency Graph&quot;">​</a></h2>`,6)),(o(),d(m,null,{default:i(()=>[n(a,{id:"mermaid-27",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20T001%20--%3E%20T011%0A%20%20%20%20T001%20--%3E%20T012%0A%20%20%20%20T001%20--%3E%20T013%0A%0A%20%20%20%20T011%20--%3E%20T021%0A%20%20%20%20T012%20--%3E%20T022%0A%20%20%20%20T013%20--%3E%20T023%0A%0A%20%20%20%20T021%20--%3E%20T024%0A%20%20%20%20T022%20--%3E%20T024%0A%20%20%20%20T023%20--%3E%20T024%0A%0A%20%20%20%20T011%20--%3E%20T031%0A%20%20%20%20T012%20--%3E%20T031%0A%20%20%20%20T031%20--%3E%20T032%0A%20%20%20%20T032%20--%3E%20T033%0A%0A%20%20%20%20T024%20--%3E%20T041%0A%20%20%20%20T024%20--%3E%20T042%0A%0A%20%20%20%20T033%20--%3E%20T051%0A%20%20%20%20T041%20--%3E%20T051%0A%20%20%20%20T042%20--%3E%20T051%0A%0A%20%20%20%20T051%20--%3E%20T900%0A%20%20%20%20T051%20--%3E%20T999%0A%20%20%20%20T900%20--%3E%20T999%0A"})]),fallback:i(()=>[...e[0]||(e[0]=[r(" Loading... ",-1)])]),_:1})),e[2]||(e[2]=l('<h2 id="quality-requirements" tabindex="-1">Quality Requirements <a class="header-anchor" href="#quality-requirements" aria-label="Permalink to &quot;Quality Requirements&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Module</th><th>Coverage</th><th>Lint</th><th>Notes</th></tr></thead><tbody><tr><td>Services (config)</td><td>n/a</td><td><code>docker compose config</code> validates</td><td>No Go/Python code</td></tr><tr><td>Dockerfiles</td><td>n/a</td><td><code>docker build</code> succeeds</td><td>Security: trivy scan</td></tr><tr><td>Workflows</td><td>n/a</td><td><code>actionlint</code> or manual review</td><td></td></tr></tbody></table><hr><h2 id="phase-1-setup" tabindex="-1">Phase 1: Setup <a class="header-anchor" href="#phase-1-setup" aria-label="Permalink to &quot;Phase 1: Setup&quot;">​</a></h2><h3 id="task-001-—-update-profiles-yaml" tabindex="-1">TASK-001 — Update profiles.yaml <a class="header-anchor" href="#task-001-—-update-profiles-yaml" aria-label="Permalink to &quot;TASK-001 — Update profiles.yaml&quot;">​</a></h3><ul><li>[x] [TASK-001] [SERVICES] [P1] Add flash, strange, sonic to <code>think</code> profile in profiles.yaml <ul><li>Dependencies: none</li><li>Module: <code>services/profiles.yaml</code></li><li>Acceptance: <ul><li><code>think</code> profile lists <code>flash</code>, <code>strange</code>, <code>sonic</code> alongside <code>cortex</code></li><li><code>reason</code> profile unchanged (it extends think implicitly via the CLI)</li><li><code>cat services/profiles.yaml</code> shows all three codenames under think</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-2-service-directories-fully-parallel" tabindex="-1">Phase 2: Service Directories (fully parallel) <a class="header-anchor" href="#phase-2-service-directories-fully-parallel" aria-label="Permalink to &quot;Phase 2: Service Directories (fully parallel)&quot;">​</a></h2><blockquote><p>All three tasks are independent. Dispatch as parallel agents.</p></blockquote><h3 id="task-011-p-—-flash-nats-service-files" tabindex="-1">TASK-011 [P] — Flash (NATS) service files <a class="header-anchor" href="#task-011-p-—-flash-nats-service-files" aria-label="Permalink to &quot;TASK-011 [P] — Flash (NATS) service files&quot;">​</a></h3><ul><li>[x] [TASK-011] [P] [SERVICES] [P1] Create <code>services/messaging/</code> — NATS Dockerfile, service.yaml, docker-compose.yml <ul><li>Dependencies: TASK-001</li><li>Module: <code>services/messaging/</code></li><li>Files to create: <ul><li><code>services/messaging/Dockerfile</code></li><li><code>services/messaging/service.yaml</code></li><li><code>services/messaging/docker-compose.yml</code></li></ul></li><li>Acceptance: <ul><li>Dockerfile <code>FROM nats:alpine</code></li><li><code>docker build -t arc-messaging:test services/messaging/</code> exits 0</li><li><code>docker inspect arc-messaging:test</code> — User field is non-root (nats user, uid 1000)</li><li><code>docker inspect arc-messaging:test</code> — Labels include <code>arc.service.codename=flash</code>, <code>arc.service.tech=nats</code></li><li><code>docker compose -f services/messaging/docker-compose.yml config</code> exits 0</li><li><code>service.yaml</code> contains: <code>name: arc-messaging</code>, <code>codename: flash</code>, <code>port: 4222</code>, <code>health: http://localhost:8222/healthz</code></li><li>Container <code>arc-messaging</code> in compose binds ports to <code>127.0.0.1</code> only</li><li>Named volume <code>arc-messaging-jetstream</code> declared (not bind mount)</li><li>Network declared as <code>arc_platform_net</code> with <code>external: true</code></li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-012-p-—-strange-pulsar-service-files" tabindex="-1">TASK-012 [P] — Strange (Pulsar) service files <a class="header-anchor" href="#task-012-p-—-strange-pulsar-service-files" aria-label="Permalink to &quot;TASK-012 [P] — Strange (Pulsar) service files&quot;">​</a></h3><ul><li>[x] [TASK-012] [P] [SERVICES] [P1] Create <code>services/streaming/</code> — Pulsar Dockerfile, service.yaml, docker-compose.yml <ul><li>Dependencies: TASK-001</li><li>Module: <code>services/streaming/</code></li><li>Files to create: <ul><li><code>services/streaming/Dockerfile</code></li><li><code>services/streaming/service.yaml</code></li><li><code>services/streaming/docker-compose.yml</code></li></ul></li><li>Acceptance: <ul><li>Dockerfile <code>FROM apachepulsar/pulsar:latest</code></li><li><code>docker build -t arc-streaming:test services/streaming/</code> exits 0</li><li><code>docker inspect arc-streaming:test</code> — Labels include <code>arc.service.codename=strange</code>, <code>arc.service.tech=pulsar</code></li><li><code>docker compose -f services/streaming/docker-compose.yml config</code> exits 0</li><li><code>service.yaml</code> contains: <code>name: arc-streaming</code>, <code>codename: strange</code>, <code>port: 6650</code>, health endpoint</li><li>Compose: <code>PULSAR_MEM: &quot;-Xms512m -Xmx1024m -XX:MaxDirectMemorySize=512m&quot;</code> and <code>--no-functions-worker</code></li><li>Compose: port <code>6650</code> binds <code>127.0.0.1:6650</code>, admin <code>8080</code> maps to <code>127.0.0.1:8082</code></li><li>Named volume <code>arc-streaming-data</code> declared</li><li>Health check uses <code>curl -f http://localhost:8080/admin/v2/brokers/health</code> with <code>start_period: 90s</code></li><li>Pulsar non-root deviation documented in compose comment (upstream constraint)</li><li>Network <code>arc_platform_net</code> with <code>external: true</code></li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-013-p-—-sonic-redis-service-files" tabindex="-1">TASK-013 [P] — Sonic (Redis) service files <a class="header-anchor" href="#task-013-p-—-sonic-redis-service-files" aria-label="Permalink to &quot;TASK-013 [P] — Sonic (Redis) service files&quot;">​</a></h3><ul><li>[x] [TASK-013] [P] [SERVICES] [P1] Create <code>services/cache/</code> — Redis Dockerfile, service.yaml, docker-compose.yml <ul><li>Dependencies: TASK-001</li><li>Module: <code>services/cache/</code></li><li>Files to create: <ul><li><code>services/cache/Dockerfile</code></li><li><code>services/cache/service.yaml</code></li><li><code>services/cache/docker-compose.yml</code></li></ul></li><li>Acceptance: <ul><li>Dockerfile <code>FROM redis:alpine</code></li><li><code>docker build -t arc-cache:test services/cache/</code> exits 0</li><li><code>docker inspect arc-cache:test</code> — User field is non-root</li><li><code>docker inspect arc-cache:test</code> — Labels include <code>arc.service.codename=sonic</code>, <code>arc.service.tech=redis</code></li><li><code>docker compose -f services/cache/docker-compose.yml config</code> exits 0</li><li><code>service.yaml</code> contains: <code>name: arc-cache</code>, <code>codename: sonic</code>, <code>port: 6379</code>, health endpoint</li><li>Compose command includes: <code>--appendonly yes</code>, <code>--appendfsync everysec</code>, <code>--maxmemory 512mb</code>, <code>--maxmemory-policy noeviction</code></li><li>Port <code>6379</code> binds <code>127.0.0.1:6379</code></li><li>Named volume <code>arc-cache-data</code> declared</li><li>Health check: <code>redis-cli ping</code> with <code>interval: 5s</code>, <code>start_period: 5s</code></li><li>Network <code>arc_platform_net</code> with <code>external: true</code></li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-3-make-targets-parallel-per-service-then-aggregate" tabindex="-1">Phase 3: Make Targets (parallel per service, then aggregate) <a class="header-anchor" href="#phase-3-make-targets-parallel-per-service-then-aggregate" aria-label="Permalink to &quot;Phase 3: Make Targets (parallel per service, then aggregate)&quot;">​</a></h2><blockquote><p>TASK-021, 022, 023 are independent. Dispatch in parallel. TASK-024 waits for all three.</p></blockquote><h3 id="task-021-p-—-flash-mk" tabindex="-1">TASK-021 [P] — flash.mk <a class="header-anchor" href="#task-021-p-—-flash-mk" aria-label="Permalink to &quot;TASK-021 [P] — flash.mk&quot;">​</a></h3><ul><li>[x] [TASK-021] [P] [SERVICES] [P1] Create <code>services/messaging/flash.mk</code> with all make targets <ul><li>Dependencies: TASK-011</li><li>Module: <code>services/messaging/flash.mk</code></li><li>Acceptance: <ul><li><code>make flash-build</code> — builds <code>arc-messaging:latest</code> image</li><li><code>make flash-up</code> — starts <code>arc-messaging</code> container; exits 0</li><li><code>make flash-health</code> — probes <code>http://localhost:8222/healthz</code>; exits 0 when healthy, non-zero when down</li><li><code>make flash-logs</code> — tails arc-messaging container logs</li><li><code>make flash-down</code> — stops and removes arc-messaging container</li><li><code>make flash-clean</code> — stops container + removes named volume (with confirmation prompt)</li><li>All targets listed in <code>.PHONY</code></li><li>Target comments follow <code>## flash-&lt;target&gt;: description</code> pattern (used by <code>make flash-help</code>)</li><li><code>make flash-help</code> prints all flash targets</li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-022-p-—-strange-mk" tabindex="-1">TASK-022 [P] — strange.mk <a class="header-anchor" href="#task-022-p-—-strange-mk" aria-label="Permalink to &quot;TASK-022 [P] — strange.mk&quot;">​</a></h3><ul><li>[x] [TASK-022] [P] [SERVICES] [P1] Create <code>services/streaming/strange.mk</code> with all make targets <ul><li>Dependencies: TASK-012</li><li>Module: <code>services/streaming/strange.mk</code></li><li>Acceptance: <ul><li><code>make strange-build</code> — builds <code>arc-streaming:latest</code> image</li><li><code>make strange-up</code> — starts <code>arc-streaming</code>; waits for health (Pulsar takes up to 90s on cold start); prints progress dots</li><li><code>make strange-health</code> — probes <code>http://localhost:8082/admin/v2/brokers/health</code>; exits 0 when healthy</li><li><code>make strange-logs</code> — tails arc-streaming container logs</li><li><code>make strange-down</code> — stops container</li><li><code>make strange-clean</code> — stops container + removes named volume (with confirmation)</li><li><code>make strange-help</code> prints all strange targets</li><li>All targets in <code>.PHONY</code></li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-023-p-—-sonic-mk" tabindex="-1">TASK-023 [P] — sonic.mk <a class="header-anchor" href="#task-023-p-—-sonic-mk" aria-label="Permalink to &quot;TASK-023 [P] — sonic.mk&quot;">​</a></h3><ul><li>[x] [TASK-023] [P] [SERVICES] [P1] Create <code>services/cache/sonic.mk</code> with all make targets <ul><li>Dependencies: TASK-013</li><li>Module: <code>services/cache/sonic.mk</code></li><li>Acceptance: <ul><li><code>make sonic-build</code> — builds <code>arc-cache:latest</code> image</li><li><code>make sonic-up</code> — starts <code>arc-cache</code>; exits 0</li><li><code>make sonic-health</code> — runs <code>docker exec arc-cache redis-cli ping</code>; exits 0 when healthy</li><li><code>make sonic-logs</code> — tails arc-cache container logs</li><li><code>make sonic-down</code> — stops container</li><li><code>make sonic-clean</code> — stops + removes volume (with confirmation)</li><li><code>make sonic-help</code> prints all sonic targets</li><li>All targets in <code>.PHONY</code></li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-024-—-messaging-mk-aggregates-makefile-wiring" tabindex="-1">TASK-024 — messaging.mk aggregates + Makefile wiring <a class="header-anchor" href="#task-024-—-messaging-mk-aggregates-makefile-wiring" aria-label="Permalink to &quot;TASK-024 — messaging.mk aggregates + Makefile wiring&quot;">​</a></h3><ul><li>[x] [TASK-024] [SERVICES] [P1] Create <code>services/messaging.mk</code> aggregates and wire all .mk files into root Makefile <ul><li>Dependencies: TASK-021, TASK-022, TASK-023</li><li>Module: <code>services/messaging.mk</code>, <code>Makefile</code></li><li>Files to create/modify: <ul><li>Create: <code>services/messaging.mk</code></li><li>Modify: <code>Makefile</code></li></ul></li><li>Acceptance: <ul><li><code>services/messaging.mk</code> contains: <ul><li><code>messaging-up</code>: creates <code>arc_platform_net</code> if missing (<code>docker network create arc_platform_net 2&gt;/dev/null || true</code>), then calls <code>flash-up</code>, <code>strange-up</code>, <code>sonic-up</code></li><li><code>messaging-down</code>: calls <code>flash-down</code>, <code>strange-down</code>, <code>sonic-down</code></li><li><code>messaging-health</code>: calls <code>flash-health</code>, <code>strange-health</code>, <code>sonic-health</code>; exits non-zero if any fails</li><li><code>messaging-logs</code>: fans out <code>docker logs -f</code> for all three containers simultaneously</li><li><code>messaging-help</code>: prints all messaging targets</li></ul></li><li><code>Makefile</code> includes: <ul><li><code>include services/messaging/flash.mk</code></li><li><code>include services/streaming/strange.mk</code></li><li><code>include services/cache/sonic.mk</code></li><li><code>include services/messaging.mk</code></li></ul></li><li><code>make help</code> shows <code>messaging-help</code> entry</li><li><code>make messaging-help</code> works from repo root</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-4-otel-integration-sequential" tabindex="-1">Phase 4: OTEL Integration (sequential) <a class="header-anchor" href="#phase-4-otel-integration-sequential" aria-label="Permalink to &quot;Phase 4: OTEL Integration (sequential)&quot;">​</a></h2><h3 id="task-031-—-update-otel-collector-config-yaml" tabindex="-1">TASK-031 — Update otel-collector-config.yaml <a class="header-anchor" href="#task-031-—-update-otel-collector-config-yaml" aria-label="Permalink to &quot;TASK-031 — Update otel-collector-config.yaml&quot;">​</a></h3><ul><li>[x] [TASK-031] [SERVICES] [P1] Add prometheus receiver to <code>services/otel/telemetry/config/otel-collector-config.yaml</code><ul><li>Dependencies: TASK-011, TASK-012</li><li>Module: <code>services/otel/telemetry/config/otel-collector-config.yaml</code></li><li>Acceptance: <ul><li><code>receivers</code> section contains a <code>prometheus</code> block with two scrape jobs: <ul><li><code>job_name: arc-messaging</code> targeting <code>arc-messaging:8222</code></li><li><code>job_name: arc-streaming</code> targeting <code>arc-streaming:8080</code></li><li>Both with <code>scrape_interval: 15s</code></li></ul></li><li><code>service.pipelines.metrics.receivers</code> updated from <code>[otlp]</code> to <code>[otlp, prometheus]</code></li><li>File is valid YAML: <code>python3 -c &quot;import yaml; yaml.safe_load(open(&#39;services/otel/telemetry/config/otel-collector-config.yaml&#39;))&quot;</code> exits 0</li><li>No other pipelines changed (traces and logs pipelines untouched)</li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-032-—-add-arc-platform-net-to-otel-collector-compose" tabindex="-1">TASK-032 — Add arc_platform_net to otel collector compose <a class="header-anchor" href="#task-032-—-add-arc-platform-net-to-otel-collector-compose" aria-label="Permalink to &quot;TASK-032 — Add arc_platform_net to otel collector compose&quot;">​</a></h3><ul><li>[x] [TASK-032] [SERVICES] [P1] Add <code>arc_platform_net</code> to <code>arc-friday-collector</code> in <code>services/otel/docker-compose.yml</code><ul><li>Dependencies: TASK-031</li><li>Module: <code>services/otel/docker-compose.yml</code></li><li>Acceptance: <ul><li><code>arc-friday-collector</code> service has both <code>arc_otel_net</code> and <code>arc_platform_net</code> in its <code>networks</code> list</li><li><code>arc_platform_net</code> declared at the bottom of the file as <code>external: true</code></li><li><code>arc_otel_net</code> definition unchanged (still internal, not external)</li><li><code>docker compose -f services/otel/docker-compose.yml config</code> exits 0</li><li>No other services in the otel compose gain <code>arc_platform_net</code> (only the collector bridges both)</li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-033-—-rebuild-and-verify-otel-collector-image" tabindex="-1">TASK-033 — Rebuild and verify otel collector image <a class="header-anchor" href="#task-033-—-rebuild-and-verify-otel-collector-image" aria-label="Permalink to &quot;TASK-033 — Rebuild and verify otel collector image&quot;">​</a></h3><ul><li>[x] [TASK-033] [SERVICES] [P1] Rebuild <code>arc-friday-collector</code> image to bake in updated config; verify it starts <ul><li>Dependencies: TASK-032</li><li>Module: <code>services/otel/</code></li><li>Acceptance: <ul><li><code>make otel-build</code> (or <code>docker compose -f services/otel/docker-compose.yml build arc-friday-collector</code>) exits 0</li><li><code>docker run --rm ghcr.io/arc-framework/arc-friday-collector:latest --config=/etc/otelcol/config.yaml validate</code> exits 0 (or equivalent config validation)</li><li>If otel stack is running locally: <code>make otel-down &amp;&amp; make otel-up</code> brings collector back healthy with new config</li><li><code>docker inspect ghcr.io/arc-framework/arc-friday-collector:latest</code> shows updated image (new layer for config)</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-5-ci-cd-workflows-parallel" tabindex="-1">Phase 5: CI/CD Workflows (parallel) <a class="header-anchor" href="#phase-5-ci-cd-workflows-parallel" aria-label="Permalink to &quot;Phase 5: CI/CD Workflows (parallel)&quot;">​</a></h2><h3 id="task-041-p-—-messaging-images-yml" tabindex="-1">TASK-041 [P] — messaging-images.yml <a class="header-anchor" href="#task-041-p-—-messaging-images-yml" aria-label="Permalink to &quot;TASK-041 [P] — messaging-images.yml&quot;">​</a></h3><ul><li>[x] [TASK-041] [P] [CI] [P1] Create <code>.github/workflows/messaging-images.yml</code> — CI pipeline for all three services <ul><li>Dependencies: TASK-024</li><li>Module: <code>.github/workflows/messaging-images.yml</code></li><li>Acceptance: <ul><li>Triggers on <code>push</code> to <code>main</code>/<code>dev</code> with path filters per service (<code>services/messaging/**</code>, <code>services/streaming/**</code>, <code>services/cache/**</code>)</li><li>Triggers on <code>pull_request</code> to <code>main</code> (build only, no push)</li><li>Triggers on <code>workflow_dispatch</code> with <code>mode: ci | release</code></li><li><code>changes</code> job uses <code>dorny/paths-filter@v3</code> — outputs <code>flash</code>, <code>strange</code>, <code>sonic</code>, <code>push-image</code></li><li>Three parallel build jobs (<code>build-flash</code>, <code>build-strange</code>, <code>build-sonic</code>), each gated on its respective change output</li><li>All three jobs use <code>_reusable-build.yml</code> with <code>platforms: linux/amd64</code> (no QEMU)</li><li><code>push-image: true</code> only on <code>main</code> push or <code>mode=release</code></li><li><code>security</code> job runs after all three builds; <code>block-on-failure: false</code> in CI</li><li>File is valid YAML; mirrors <code>cortex-images.yml</code> structure</li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-042-p-—-messaging-release-yml" tabindex="-1">TASK-042 [P] — messaging-release.yml <a class="header-anchor" href="#task-042-p-—-messaging-release-yml" aria-label="Permalink to &quot;TASK-042 [P] — messaging-release.yml&quot;">​</a></h3><ul><li>[x] [TASK-042] [P] [CI] [P1] Create <code>.github/workflows/messaging-release.yml</code> — release pipeline on <code>messaging/v*</code> tags <ul><li>Dependencies: TASK-024</li><li>Module: <code>.github/workflows/messaging-release.yml</code></li><li>Acceptance: <ul><li>Triggers on <code>push</code> with tag pattern <code>messaging/v*</code></li><li><code>prepare</code> job derives <code>image-tag</code> (<code>messaging/v0.1.0</code> → <code>messaging-v0.1.0</code>), <code>version</code>, <code>prerelease</code> flag</li><li>Three build jobs (<code>build-flash</code>, <code>build-strange</code>, <code>build-sonic</code>) run in parallel after <code>prepare</code></li><li>All three use <code>_reusable-build.yml</code> with <code>platforms: linux/amd64,linux/arm64</code>, <code>push-image: true</code>, <code>latest-tag: true</code></li><li><code>security</code> job runs after all three builds; <code>block-on-failure: true</code>, <code>create-issues: true</code></li><li><code>release</code> job creates GitHub release with image reference table (mirrors <code>cortex-release.yml</code> release notes format)</li><li><code>permissions: contents: write, packages: write, security-events: write, issues: write</code></li><li>File is valid YAML</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-6-integration" tabindex="-1">Phase 6: Integration <a class="header-anchor" href="#phase-6-integration" aria-label="Permalink to &quot;Phase 6: Integration&quot;">​</a></h2><h3 id="task-051-—-end-to-end-health-verification" tabindex="-1">TASK-051 — End-to-end health verification <a class="header-anchor" href="#task-051-—-end-to-end-health-verification" aria-label="Permalink to &quot;TASK-051 — End-to-end health verification&quot;">​</a></h3><ul><li>[x] [TASK-051] [SERVICES] [P1] Verify full stack: messaging-up, health checks, otel metrics flow <ul><li>Dependencies: TASK-033, TASK-041, TASK-042</li><li>Module: <code>services/</code> (runtime verification, no file changes)</li><li>Acceptance: <ul><li><code>docker network create arc_platform_net 2&gt;/dev/null || true</code> — network exists</li><li><code>make messaging-up</code> exits 0; all three containers in <code>healthy</code> state (<code>docker compose ps</code> or <code>docker inspect</code>)</li><li><code>make messaging-health</code> exits 0</li><li><code>make flash-health</code> exits 0 independently</li><li><code>make strange-health</code> exits 0 independently (allow up to 90s on cold start)</li><li><code>make sonic-health</code> exits 0 independently</li><li><code>make messaging-down</code> stops all three; no orphaned containers (<code>docker ps -a | grep arc-messaging</code> etc.)</li><li><code>make messaging-up</code> is idempotent (run twice, no error on second run)</li><li>If otel stack running: <code>curl -s http://localhost:8222/metrics</code> returns NATS Prometheus data; collector scrape visible in SigNoz</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="phase-7-polish" tabindex="-1">Phase 7: Polish <a class="header-anchor" href="#phase-7-polish" aria-label="Permalink to &quot;Phase 7: Polish&quot;">​</a></h2><h3 id="task-900-—-docs-links-update" tabindex="-1">TASK-900 — Docs &amp; links update <a class="header-anchor" href="#task-900-—-docs-links-update" aria-label="Permalink to &quot;TASK-900 — Docs &amp; links update&quot;">​</a></h3><ul><li>[x] [TASK-900] [P] [DOCS] [P1] Docs &amp; links update <ul><li>Dependencies: TASK-051</li><li>Module: <code>services/profiles.yaml</code>, <code>services/cortex/service.yaml</code>, <code>CLAUDE.md</code></li><li>Acceptance: <ul><li><code>services/cortex/service.yaml</code> <code>depends_on</code> codenames (<code>flash</code>, <code>strange</code>, <code>sonic</code>) match the <code>name</code> fields in each new <code>service.yaml</code></li><li><code>CLAUDE.md</code> service codename table reflects: messaging=flash/nats, streaming=strange/pulsar, cache=sonic/redis</li><li>No broken cross-references introduced</li></ul></li><li>Status: [x] done</li></ul></li></ul><h3 id="task-999-—-reviewer-agent-verification" tabindex="-1">TASK-999 — Reviewer agent verification <a class="header-anchor" href="#task-999-—-reviewer-agent-verification" aria-label="Permalink to &quot;TASK-999 — Reviewer agent verification&quot;">​</a></h3><ul><li>[x] [TASK-999] [REVIEW] [P1] Reviewer agent verifies all tasks complete, quality gates met <ul><li>Dependencies: ALL</li><li>Module: all affected modules</li><li>Acceptance: <ul><li>All TASK-001 through TASK-900 marked <code>[x]</code> done</li><li><code>make messaging-up &amp;&amp; make messaging-health</code> exits 0</li><li>All Dockerfiles build without error</li><li><code>docker compose config</code> exits 0 for all three new compose files and the updated otel compose</li><li><code>messaging-images.yml</code> and <code>messaging-release.yml</code> are valid YAML</li><li>No secrets or credentials in any committed file</li><li>Pulsar non-root deviation is documented inline (not a silent violation)</li><li>Constitution compliance: II, III, VII, VIII, XI all passing per plan.md checklist</li></ul></li><li>Status: [x] done</li></ul></li></ul><hr><h2 id="progress-summary" tabindex="-1">Progress Summary <a class="header-anchor" href="#progress-summary" aria-label="Permalink to &quot;Progress Summary&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Phase</th><th>Total</th><th>Done</th><th>Parallel</th></tr></thead><tbody><tr><td>Setup</td><td>1</td><td>1</td><td>0</td></tr><tr><td>Service Directories</td><td>3</td><td>3</td><td>3</td></tr><tr><td>Make Targets</td><td>4</td><td>4</td><td>3</td></tr><tr><td>OTEL Integration</td><td>3</td><td>3</td><td>0</td></tr><tr><td>CI/CD Workflows</td><td>2</td><td>2</td><td>2</td></tr><tr><td>Integration</td><td>1</td><td>1</td><td>0</td></tr><tr><td>Polish</td><td>2</td><td>2</td><td>1</td></tr><tr><td><strong>Total</strong></td><td><strong>16</strong></td><td><strong>16</strong></td><td><strong>9</strong></td></tr></tbody></table>',53))])}const S=c(h,[["render",u]]);export{T as __pageData,S as default};
