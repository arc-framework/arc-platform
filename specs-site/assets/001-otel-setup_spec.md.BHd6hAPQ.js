import{_ as a,C as l,o as t,c as r,a2 as i,b as d,w as s,a as n,E as c,a3 as h}from"./chunks/framework.C-cuuT8Z.js";const f=JSON.parse('{"title":"Feature: 001-otel-setup — Stand Up SigNoz as the Observability Backend","description":"","frontmatter":{},"headers":[],"relativePath":"001-otel-setup/spec.md","filePath":"001-otel-setup/spec.md","lastUpdated":1771749142000}'),p={name:"001-otel-setup/spec.md"};function k(g,e,u,y,m,E){const o=l("Mermaid");return t(),r("div",null,[e[1]||(e[1]=i('<h1 id="feature-001-otel-setup-—-stand-up-signoz-as-the-observability-backend" tabindex="-1">Feature: 001-otel-setup — Stand Up SigNoz as the Observability Backend <a class="header-anchor" href="#feature-001-otel-setup-—-stand-up-signoz-as-the-observability-backend" aria-label="Permalink to &quot;Feature: 001-otel-setup — Stand Up SigNoz as the Observability Backend&quot;">​</a></h1><blockquote><p><strong>Spec</strong>: 001-otel-setup <strong>Date</strong>: 2026-02-21 <strong>Status</strong>: Draft</p></blockquote><h2 id="target-modules" tabindex="-1">Target Modules <a class="header-anchor" href="#target-modules" aria-label="Permalink to &quot;Target Modules&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Module</th><th>Path</th><th>Impact</th></tr></thead><tbody><tr><td>Services</td><td><code>services/otel/observability/</code></td><td>New directory — SigNoz UI, ClickHouse, ZooKeeper</td></tr><tr><td>Services</td><td><code>services/otel/telemetry/</code></td><td>New directory — OTEL collector (Black Widow)</td></tr><tr><td>Root</td><td><code>Makefile</code></td><td>Extend with <code>otel-*</code> targets — single orchestration entrypoint</td></tr></tbody></table><p>No CLI, SDK, or docs changes in this spec.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Add SigNoz as the A.R.C. observability backend. Two service directories live under <code>services/otel/</code> — <code>telemetry/</code> (OTEL collector) and <code>observability/</code> (SigNoz + storage). Each owns its own <code>docker-compose.yml</code>; all operations are invoked from the <strong>single root <code>Makefile</code></strong> via <code>otel-*</code> targets (e.g. <code>make otel-up</code>). Raw <code>docker compose</code> is never the intended interface. Once running, the SigNoz UI is reachable at <code>localhost:3301</code> and the collector accepts OTLP signals on ports 4317/4318. This spec covers infrastructure setup only; SDK instrumentation is a future spec.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h2>',8)),(t(),d(h,null,{default:s(()=>[c(o,{id:"mermaid-73",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20SDK%5B%22OTEL%20SDK%5Cn(any%20future%20arc%20service)%22%5D%0A%20%20%20%20SDK%20--%3E%7C%22OTLP%20gRPC%20%3A4317%5CnOTLP%20HTTP%20%3A4318%22%7C%20BW%0A%0A%20%20%20%20subgraph%20otel%20%5B%22services%2Fotel%2F%22%5D%0A%20%20%20%20%20%20%20%20subgraph%20telemetry%20%5B%22telemetry%2F%20%E2%80%94%20Black%20Widow%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20BW%5B%22signoz-otel-collector%22%5D%0A%20%20%20%20%20%20%20%20end%0A%0A%20%20%20%20%20%20%20%20subgraph%20observability%20%5B%22observability%2F%20%E2%80%94%20Friday%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20ZK%5B%22ZooKeeper%5Cn(ClickHouse%20coordination)%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20CH%5B%22ClickHouse%5Cn(signal%20store)%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20SN%5B%22SigNoz%5Cn(query%20service%20%2B%20UI%20%3A3301)%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20ZK%20--%3E%20CH%0A%20%20%20%20%20%20%20%20%20%20%20%20CH%20--%3E%20SN%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20end%0A%0A%20%20%20%20BW%20--%3E%7C%22OTLP%20export%22%7C%20CH%0A%20%20%20%20BW%20-.-%3E%7C%22health%20%3A13133%22%7C%20BW%0A%20%20%20%20SN%20-.-%3E%7C%22API%20health%20%3A3301%2Fapi%2Fv1%2Fhealth%22%7C%20SN%0A%0A%20%20%20%20MK%5B%22arc-platform%2FMakefile%5Cn(single%20root%20%E2%80%94%20otel-up%20%2F%20otel-down%20%2F%20otel-health)%22%5D%0A%20%20%20%20MK%20--%3E%7Corchestrates%7C%20telemetry%0A%20%20%20%20MK%20--%3E%7Corchestrates%7C%20observability%0A"})]),fallback:s(()=>[...e[0]||(e[0]=[n(" Loading... ",-1)])]),_:1})),e[2]||(e[2]=i(`<h2 id="makefile-design" tabindex="-1">Makefile Design <a class="header-anchor" href="#makefile-design" aria-label="Permalink to &quot;Makefile Design&quot;">​</a></h2><p><strong>Single root <code>Makefile</code></strong> at <code>arc-platform/Makefile</code>. Pattern mirrors platform-spike: compose variables point at per-service compose files; no <code>cd</code> required.</p><div class="language-makefile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">makefile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Compose variable references (root Makefile additions)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE                  := docker compose</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE_OTEL_TELEMETRY   := </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -f services/otel/telemetry/docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE_OTEL_OBSERVABILITY := </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -f services/otel/observability/docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE_OTEL             := </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">$(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPOSE_OTEL_TELEMETRY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                            -f services/otel/observability/docker-compose.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Target reference</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-up               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># full otel stack (telemetry + observability)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-up-observability </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SigNoz + ClickHouse + ZooKeeper only</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-up-telemetry     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># collector only</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-down             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># tear down full stack</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-health           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># probe both health endpoints; exit non-zero on failure</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-logs             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># stream logs from all otel containers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">make otel-ps               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># show container status</span></span></code></pre></div><h2 id="user-scenarios-testing" tabindex="-1">User Scenarios &amp; Testing <a class="header-anchor" href="#user-scenarios-testing" aria-label="Permalink to &quot;User Scenarios &amp; Testing&quot;">​</a></h2><h3 id="p1-—-must-have" tabindex="-1">P1 — Must Have <a class="header-anchor" href="#p1-—-must-have" aria-label="Permalink to &quot;P1 — Must Have&quot;">​</a></h3><p><strong>US-1</strong>: As a developer, I want to start the full SigNoz stack with a single make command so that the UI is reachable without manual steps.</p><ul><li><strong>Given</strong>: <code>make otel-up</code> is run from the repo root (<code>arc-platform/</code>)</li><li><strong>When</strong>: All containers report healthy (ClickHouse, ZooKeeper, signoz-otel-collector, SigNoz)</li><li><strong>Then</strong>: <code>http://localhost:3301</code> returns the SigNoz UI within 60 seconds</li><li><strong>Test</strong>: <code>curl -sf http://localhost:3301/api/v1/health</code> returns HTTP 200; <code>make otel-health</code> exits 0</li></ul><p><strong>US-2</strong>: As a developer, I want the OTEL collector to accept a test span so that I can verify the full pipeline before instrumenting any arc service.</p><ul><li><strong>Given</strong>: <code>make otel-up</code> has been run and <code>make otel-health</code> exits 0</li><li><strong>When</strong>: A test span is sent to <code>localhost:4317</code> via <code>telemetrygen</code></li><li><strong>Then</strong>: The span appears in SigNoz → Traces within 30 seconds</li><li><strong>Test</strong>: <code>docker run --rm --network host ghcr.io/open-telemetry/opentelemetry-collector-contrib/telemetrygen:latest traces --otlp-insecure --otlp-endpoint localhost:4317</code> then verify in SigNoz UI</li></ul><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><h3 id="functional" tabindex="-1">Functional <a class="header-anchor" href="#functional" aria-label="Permalink to &quot;Functional&quot;">​</a></h3><ul><li>[ ] FR-1: <code>services/otel/observability/</code> directory exists with <code>service.yaml</code>, <code>docker-compose.yml</code>, and <code>config/</code></li><li>[ ] FR-2: <code>services/otel/telemetry/</code> directory exists with <code>service.yaml</code>, <code>docker-compose.yml</code>, and <code>config/otel-collector-config.yaml</code></li><li>[ ] FR-3: Root <code>Makefile</code> (<code>arc-platform/Makefile</code>) is extended with <code>otel-up</code>, <code>otel-up-observability</code>, <code>otel-up-telemetry</code>, <code>otel-down</code>, <code>otel-health</code>, <code>otel-logs</code>, <code>otel-ps</code> targets</li><li>[ ] FR-4: <code>make otel-up</code> from repo root starts all four containers (SigNoz, ClickHouse, ZooKeeper, signoz-otel-collector)</li><li>[ ] FR-5: <code>make otel-health</code> probes both health endpoints and exits non-zero if either fails</li><li>[ ] FR-6: SigNoz UI is reachable at <code>http://localhost:3301</code> after <code>make otel-up</code> completes healthy</li><li>[ ] FR-7: OTEL collector accepts OTLP gRPC on <code>:4317</code> and OTLP HTTP on <code>:4318</code></li><li>[ ] FR-8: <code>otel-collector-config.yaml</code> is the single place to configure receivers and exporters — no per-service collector configs</li><li>[ ] FR-9: Health check for <code>observability/</code> passes only when the SigNoz API (<code>/api/v1/health</code>) responds, not just when containers are running</li><li>[ ] FR-10: ClickHouse and ZooKeeper are NOT exposed externally (internal Docker network only)</li><li>[ ] FR-11: SigNoz UI is bound to <code>127.0.0.1</code> only (not <code>0.0.0.0</code>)</li><li>[ ] FR-12: <code>make otel-down</code> cleanly stops and removes all otel stack containers</li><li>[ ] FR-13: All otel containers follow <code>arc-friday-*</code> naming — <code>arc-friday</code>, <code>arc-friday-collector</code>, <code>arc-friday-clickhouse</code>, <code>arc-friday-zookeeper</code>, <code>arc-friday-migrator-sync</code>, <code>arc-friday-migrator-async</code></li><li>[ ] FR-14: All ARC images published to <code>ghcr.io/arc-framework/arc-friday-*</code> (vendor re-tag strategy — Approach C from platform-spike)</li><li>[ ] FR-15: Vendor images (<code>arc-friday</code>, <code>arc-friday-collector</code>, <code>arc-friday-clickhouse</code>, <code>arc-friday-zookeeper</code>) built via <code>.github/workflows/otel-images.yml</code>; weekly re-tag config at <code>.github/config/publish-observability.json</code></li><li>[ ] FR-16: <code>make otel-build</code> produces locally tagged images matching <code>ghcr.io/arc-framework/arc-friday-*</code> refs so dev and CI use identical image names</li></ul><h3 id="non-functional" tabindex="-1">Non-Functional <a class="header-anchor" href="#non-functional" aria-label="Permalink to &quot;Non-Functional&quot;">​</a></h3><ul><li>[ ] NFR-1: <strong>ClickHouse minimum RAM: 4GB</strong> — document as prerequisite in <code>services/otel/observability/README.md</code></li><li>[ ] NFR-2: SigNoz UI must be reachable within 60 seconds of all containers starting</li><li>[ ] NFR-3: Collector health endpoint (<code>http://localhost:13133/</code>) must return 200 when running</li><li>[ ] NFR-4: All containers run as non-root (Principle VIII)</li><li>[ ] NFR-5: No secrets committed to git; any credentials use env files listed in <code>.gitignore</code></li></ul><h3 id="key-entities" tabindex="-1">Key Entities <a class="header-anchor" href="#key-entities" aria-label="Permalink to &quot;Key Entities&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Entity</th><th>Module</th><th>Description</th></tr></thead><tbody><tr><td><code>Makefile</code> (extended)</td><td><code>arc-platform/</code></td><td>Root orchestration — <code>otel-*</code> targets added; single entrypoint for all services</td></tr><tr><td><code>service.yaml</code> (friday)</td><td><code>services/otel/observability/</code></td><td>Codename, tech, health endpoint, compose services list</td></tr><tr><td><code>service.yaml</code> (widow)</td><td><code>services/otel/telemetry/</code></td><td>Codename, tech, ports, health endpoint, upstream image</td></tr><tr><td><code>docker-compose.yml</code></td><td><code>services/otel/observability/</code></td><td>SigNoz + ClickHouse + ZooKeeper stack</td></tr><tr><td><code>docker-compose.yml</code></td><td><code>services/otel/telemetry/</code></td><td>signoz-otel-collector container</td></tr><tr><td><code>otel-collector-config.yaml</code></td><td><code>services/otel/telemetry/config/</code></td><td>OTLP receivers, SigNoz exporter, health extension</td></tr></tbody></table><h3 id="service-yaml-shapes" tabindex="-1">service.yaml Shapes <a class="header-anchor" href="#service-yaml-shapes" aria-label="Permalink to &quot;service.yaml Shapes&quot;">​</a></h3><p><strong>services/otel/telemetry/service.yaml</strong> (Black Widow):</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">codename</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">widow</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tech</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">signoz-otel-collector</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">upstream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">signoz/signoz-otel-collector</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4317</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # OTLP gRPC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4318</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # OTLP HTTP</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">health</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://localhost:13133/</span></span></code></pre></div><p><strong>services/otel/observability/service.yaml</strong> (Friday):</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">codename</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">friday</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tech</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">signoz</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">depends_on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">telemetry</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">health</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://localhost:3301/api/v1/health</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">compose_services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">signoz</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">clickhouse</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">zookeeper</span></span></code></pre></div><h2 id="image-strategy" tabindex="-1">Image Strategy <a class="header-anchor" href="#image-strategy" aria-label="Permalink to &quot;Image Strategy&quot;">​</a></h2><p>Follows Approach C from platform-spike: two-tier model.</p><ul><li><strong>ARC native services</strong> (sherlock, scarlett, raymond): built FROM <code>arc-base-python-ai</code> or <code>arc-base-go-infra</code> — custom Dockerfiles with ARC-specific tooling baked in.</li><li><strong>Vendor/infra services</strong> (arc-friday, arc-friday-collector, arc-friday-clickhouse, arc-friday-zookeeper): simple re-tag of upstream SigNoz/ClickHouse images under <code>ghcr.io/arc-framework/arc-friday-*</code>. ARC-specific config (ClickHouse tuning, collector endpoints, histogramQuantile UDF) is baked into the Dockerfile layers at build time. Weekly re-tag via <code>publish-vendor-images.yml</code> ensures upstream security patches propagate automatically.</li></ul><table tabindex="0"><thead><tr><th>Image</th><th>Source</th><th>Dockerfile</th><th>Config baked in</th></tr></thead><tbody><tr><td><code>arc-friday</code></td><td><code>signoz/signoz:v0.112.0</code></td><td><code>observability/Dockerfile</code></td><td><code>prometheus.yml</code></td></tr><tr><td><code>arc-friday-collector</code></td><td><code>signoz/signoz-otel-collector:v0.142.0</code></td><td><code>telemetry/Dockerfile</code></td><td>collector config + opamp config</td></tr><tr><td><code>arc-friday-clickhouse</code></td><td><code>clickhouse/clickhouse-server:25.5.6</code></td><td><code>observability/clickhouse.Dockerfile</code></td><td>ClickHouse config, users.xml, <code>histogramQuantile</code> UDF binary</td></tr><tr><td><code>arc-friday-zookeeper</code></td><td><code>signoz/zookeeper:3.7.1</code></td><td><code>observability/zookeeper.Dockerfile</code></td><td>ARC labels only</td></tr></tbody></table><p>Re-tag config: <code>.github/config/publish-observability.json</code> Build workflow: <code>.github/workflows/otel-images.yml</code> Reusable CI primitives: <code>.github/workflows/_reusable-build.yml</code>, <code>_reusable-security.yml</code>, <code>_reusable-publish-group.yml</code></p><h2 id="edge-cases" tabindex="-1">Edge Cases <a class="header-anchor" href="#edge-cases" aria-label="Permalink to &quot;Edge Cases&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Scenario</th><th>Expected Behavior</th></tr></thead><tbody><tr><td>ClickHouse OOM (&lt; 4GB RAM)</td><td>Container exits; <code>make otel-health</code> fails; error visible in <code>make otel-logs</code></td></tr><tr><td>SigNoz starts before ClickHouse is ready</td><td><code>depends_on</code> with <code>condition: service_healthy</code> in compose prevents premature start</td></tr><tr><td>Collector starts before SigNoz/ClickHouse is ready</td><td>Collector retries export; spans buffered up to queue limit; no data loss for short startup gaps</td></tr><tr><td>Port 3301 already in use</td><td><code>make otel-up</code> fails at bind; error message identifies conflicting port</td></tr><tr><td>Port 4317/4318 already in use</td><td><code>make otel-up</code> fails at bind; error message identifies conflicting port</td></tr><tr><td><code>make otel-up-observability</code> run without telemetry</td><td>SigNoz starts and is accessible; no collector means no ingestion (expected, documented)</td></tr></tbody></table><h2 id="success-criteria" tabindex="-1">Success Criteria <a class="header-anchor" href="#success-criteria" aria-label="Permalink to &quot;Success Criteria&quot;">​</a></h2><ul><li>[ ] SC-1: <code>make otel-up</code> from repo root exits 0 and all four containers reach healthy state</li><li>[ ] SC-2: <code>make otel-health</code> exits 0 after <code>make otel-up</code>; exits non-zero if any endpoint is unreachable</li><li>[ ] SC-3: <code>curl -sf http://localhost:3301/api/v1/health</code> returns HTTP 200</li><li>[ ] SC-4: <code>curl -sf http://localhost:13133/</code> returns HTTP 200 (collector health)</li><li>[ ] SC-5: A test span sent to <code>:4317</code> appears in SigNoz → Traces within 30 seconds</li><li>[ ] SC-6: ClickHouse port is NOT accessible from the host (<code>nc -z localhost 9000</code> fails)</li><li>[ ] SC-7: ZooKeeper port is NOT accessible from the host (<code>nc -z localhost 2181</code> fails)</li></ul><h2 id="docs-links-update" tabindex="-1">Docs &amp; Links Update <a class="header-anchor" href="#docs-links-update" aria-label="Permalink to &quot;Docs &amp; Links Update&quot;">​</a></h2><ul><li>[ ] Create <code>services/otel/observability/README.md</code> — prerequisites (4GB RAM), <code>make up</code> quickstart, health check URL, UI URL</li><li>[ ] Create <code>services/otel/telemetry/README.md</code> — collector config reference: open receivers (OTLP gRPC/HTTP), export target, health endpoint</li></ul><h2 id="constitution-compliance" tabindex="-1">Constitution Compliance <a class="header-anchor" href="#constitution-compliance" aria-label="Permalink to &quot;Constitution Compliance&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Principle</th><th>Applies</th><th>Compliant</th><th>Notes</th></tr></thead><tbody><tr><td>I. Zero-Dependency CLI</td><td>N/A</td><td>—</td><td>CLI scope only</td></tr><tr><td>II. Platform-in-a-Box</td><td>✓</td><td>✓</td><td><code>make otel-up</code> works with zero manual config; root Makefile is the declared interface</td></tr><tr><td>III. Modular Services</td><td>✓</td><td>✓</td><td>Each subdirectory is self-contained with own <code>service.yaml</code>; root Makefile references compose files directly</td></tr><tr><td>IV. Two-Brain Separation</td><td>N/A</td><td>—</td><td>Infrastructure config only; no Go/Python mixing</td></tr><tr><td>V. Polyglot Standards</td><td>N/A</td><td>—</td><td>OTEL SDK instrumentation is the next spec</td></tr><tr><td>VI. Local-First</td><td>N/A</td><td>—</td><td>CLI scope only</td></tr><tr><td>VII. Observability by Default</td><td>✓</td><td>✓</td><td>This spec IS the observability foundation</td></tr><tr><td>VIII. Security by Default</td><td>✓</td><td>✓</td><td>Non-root containers; ClickHouse/ZK not externally exposed; UI bound to 127.0.0.1</td></tr><tr><td>IX. Declarative Reconciliation</td><td>N/A</td><td>—</td><td>CLI scope only</td></tr><tr><td>X. Stateful Operations</td><td>N/A</td><td>—</td><td>CLI scope only</td></tr><tr><td>XI. Resilience Testing</td><td>N/A</td><td>—</td><td>Chaos engineering is a follow-on concern</td></tr><tr><td>XII. Interactive Experience</td><td>N/A</td><td>—</td><td>CLI scope only</td></tr></tbody></table>`,34))])}const v=a(p,[["render",k]]);export{f as __pageData,v as default};
